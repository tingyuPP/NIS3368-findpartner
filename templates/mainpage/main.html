{% load static %}
<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>笔记详情</title>
    <link rel="stylesheet" href="{% static 'css/main.css'%}">
    <link rel="stylesheet" href="{% static 'css/pushbutton.css'%}">
    <link rel="shortcut icon" href="{% static 'images/favicon.ico' %}">
</head>

<body>
    <div class="note-detail-mask">
        <div class="note-container">
            <div class="media-container">
                <div class="carousel">
                    <div class="carousel-item">
                        <img src="{{ post.image }}" alt="图片">
                    </div>
                </div>
            </div>
            <div class="interaction-container">
                <div class="author-container">
                    <div class="author-me">
                        <div class="info">
                            <a href="/my/{{ author.id }}/">
                                <img class="avatar-item" src="{{ author.image }}" alt="头像">
                            </a>
                            <span class="name">{{ author.nickname }}</span>
                        </div>
                    </div>
                    <div class="note-scroller">
                        <div class="note-content">
                            <div class="title">{{ post.title }}</div>
                            <div class="desc">
                                <span>{{ post.description }} <br></span>
                                {% for tag in post.tag %}
                                <a class="tag tag-search">#{{ tag }}</a>
                                {% endfor %}
                                


                            </div>
                            <div class="bottom-container">
                                <span class="date">{{ post.time }}</span>
                            </div>
                        </div>
                    </div>
                </div>
                <a href="javascript:;" class="invite-button" onclick="sendmyinvitation()">发送邀请</a>
            </div>
        </div>
        <div class="close-cricle" onclick="closeNoteDetail()">
            <div class="close close-mask-white">
                <span class="close-icon">✖️</span>
            </div>
        </div>
    </div>
</body>

<script>
    function closeNoteDetail() {
        history.back();
    }
    window.addEventListener('popstate', function(event) {
        location.reload(); // 刷新页面
    });
    function sendmyinvitation() {
            const noticeId = '{{ post.id }}'; // 替换为实际的notice_id


            

            fetch('/api/request_notice', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ notice_id: noticeId })
            })
                .then(response => response.json())
                .then(data => {
                    if (data.success === 0) {
                        alert('请求成功');
                    } else if (data.success === -1) {
                        alert('用户不存在');
                    } else if (data.success === -2) {
                        alert('需求不存在');
                    } 

                    else {
                        alert('请求失败');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }
</script>

</html>